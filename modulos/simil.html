<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Módulo Interactivo: Símil o Comparación</title>

    <!-- Font Awesome para los iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
        
    <!-- Enlace a tu CSS externo -->
    <link rel="stylesheet" href="../css/modules.css">
</head>
<body>

    <header class="main-header">
        <a href="../index.html" class="back-link"><i class="fa-solid fa-arrow-left"></i> Volver</a>
        <h1><i class="fa-solid fa-scale-balanced"></i>Símil o Comparación</h1>
        <button id="theme-toggle" class="theme-toggle-btn" title="Cambiar tema"><i class="fa-solid fa-moon"></i></button>
    </header>

    <main class="container" id="module-content">
       
        <section class="module-section">
            <h2><i class="fa-solid fa-circle-question"></i>1. ¿Qué es un Símil?</h2>
            <p>El símil, o comparación, es una figura que establece una relación de semejanza entre dos elementos (uno real y uno imaginario). La característica principal y que lo diferencia de la metáfora es que <strong>siempre utiliza un nexo comparativo</strong> explícito.</p>
            <div class="formula">
                <p><i class="fa-solid fa-link"></i><strong>Término Real (A)</strong> + <mark>Nexo ("como", "parece", "tal cual")</mark> + <strong>Término Imaginario (B)</strong></p>
            </div>
            <p>Por ejemplo, en "Tus ojos brillan <mark>como</mark> dos luceros", la comparación es directa y evidente gracias al nexo "como". No se afirma que los ojos *son* luceros, sino que se *parecen* a ellos en su brillo.</p>
        </section>

        <section class="module-section">
            <h2><i class="fa-solid fa-comments"></i>2. Ejemplos</h2>
            <h3>En la Vida Cotidiana</h3>
            <ul>
                <li><i class="fa-solid fa-horse-head fa-fw"></i>"Es terco <mark>como</mark> una mula."</li>
                <li><i class="fa-solid fa-shirt fa-fw"></i>"Sus manos, suaves <mark>cual</mark> terciopelo."</li>
                <li><i class="fa-solid fa-person-running fa-fw"></i>"El atleta corría <mark>tal que</mark> una gacela."</li>
            </ul>
             <hr style="margin: 2rem 0;">
             <h3>En la Biblia (Reina Valera 1960)</h3>
            <div class="bible-example">
                <em>"Será <mark>como</mark> árbol plantado junto a corrientes de aguas, Que da su fruto en su tiempo..." (Salmo 1:3)</em>
                <p><i class="fa-solid fa-magnifying-glass-chart"></i><strong>Análisis:</strong> La persona justa se compara con un "árbol frondoso" usando el nexo "como" para resaltar su prosperidad y estabilidad.</p>
            </div>
            <div class="bible-example">
                <em>"...sed, pues, prudentes <mark>como</mark> serpientes, y sencillos <mark>como</mark> palomas." (Mateo 10:16)</em>
                <p><i class="fa-solid fa-magnifying-glass-chart"></i><strong>Análisis:</strong> Se compara a los discípulos con "serpientes" en prudencia y con "palomas" en sencillez, usando dos símiles claros.</p>
            </div>
        </section>

        <section class="module-section">
            <h2><i class="fa-solid fa-wand-magic-sparkles"></i>3. El Poder del Efecto: Antes y Después</h2>
            <p>Observa cómo un símil hace una descripción más evocadora. Haz clic en el botón para ver la transformación.</p>
            <div class="comparison-box">
                <div id="before-text">
                    <h4><i class="fa-solid fa-align-left"></i>Versión Literal</h4>
                    <p>La noche era muy oscura.</p>
                </div>
                <div id="after-text" style="display: none;">
                    <h4><i class="fa-solid fa-angles-right"></i>Versión con Símil</h4>
                    <p>La noche era oscura <mark>como</mark> boca de lobo.</p>
                </div>
                <button id="transform-btn"><i class="fa-solid fa-repeat"></i>Mostrar Efecto</button>
            </div>
        </section>

        <section class="module-section">
            <h2><i class="fa-solid fa-mouse-pointer"></i>4. ¡Ahora tú! Identifícalo</h2>
            <p>Haz clic en el <strong>Término Real</strong>, el <strong>Nexo</strong> y el <strong>Término Imaginario</strong> en cada símil.</p>
            <div id="interactive-finder">
                <div class="sentence-container">
                    <p class="find-me"><span class="simil-part">Sus ojos</span> brillaban <span class="simil-part">como</span> <span class="simil-part">dos estrellas</span>.</p>
                    <p class="feedback-finder"></p>
                </div>
                <div class="sentence-container">
                    <p class="find-me">Tu risa suena <span class="simil-part">tal cual</span> <span class="simil-part">música celestial</span>.</p>
                    <p class="feedback-finder"></p>
                </div>
                <div class="sentence-container">
                    <p class="find-me"><span class="simil-part">El niño</span> es tan inquieto <span class="simil-part">cual</span> <span class="simil-part">un mono</span>.</p>
                    <p class="feedback-finder"></p>
                </div>
            </div>
        </section>

        <section class="module-section exercise">
            <h2><i class="fa-solid fa-pencil-alt"></i>5. Ejercicio Práctico</h2>
            <p>Lee el siguiente versículo. Identifica el término real, el imaginario y el nexo del símil, y explica brevemente su significado.</p>
            <p><em>"<mark>Como</mark> el agua fría al alma sedienta, Así son las buenas nuevas de lejanas tierras." (Proverbios 25:25)</em></p>
            <textarea id="exercise-answer" rows="10" placeholder="Término Real: ...&#10;Término Imaginario: ...&#10;Nexo: ... &#10;Explicación: ..."></textarea>
            <div class="buttons-container">
                <button id="check-answer-btn"><i class="fa-solid fa-check-circle"></i>Verificar Respuesta</button>
                <button id="show-answer-btn" style="display: none;"><i class="fa-solid fa-eye"></i>Ver Respuesta Correcta</button>
            </div>
            <p id="feedback" class="feedback"></p>
            <div id="correct-answer" class="correct-answer-box" style="display: none;">
                <h4>Respuesta Detallada:</h4>
                <p><strong>Término Real:</strong> "Las buenas nuevas de lejanas tierras".</p>
                <p><strong>Término Imaginario:</strong> "El agua fría al alma sedienta".</p>
                <p><strong>Nexo:</strong> "Como" y "Así son".</p>
                <p><strong>Explicación:</strong> Compara el efecto reconfortante de las buenas noticias con el alivio de beber agua fría, pues ambos satisfacen un profundo anhelo.</p>
            </div>
        </section>

        <section class="module-section">
            <h2><i class="fa-solid fa-clipboard-question"></i>6. Mini-Quiz Rápido</h2>
            <p>¡Pongamos a prueba lo aprendido! Elige la respuesta correcta.</p>
            <form id="mini-quiz-form">
                <div class="quiz-question">
                    <p><strong>1. ¿Qué elemento es INDISPENSABLE en un símil?</strong></p>
                    <label><input type="radio" name="q1" value="a"> Una exageración.</label><br>
                    <label><input type="radio" name="q1" value="b"> Un nexo comparativo explícito (como, cual, parece...).</label><br>
                    <label><input type="radio" name="q1" value="c"> La ausencia de un término real.</label><br>
                </div>
                <div class="quiz-question">
                    <p><strong>2. "La vida es un sueño" es una metáfora. ¿Cómo la convertirías en un símil?</strong></p>
                    <label><input type="radio" name="q2" value="a"> Soñar es vivir.</label><br>
                    <label><input type="radio" name="q2" value="b"> El sueño de la vida.</label><br>
                    <label><input type="radio" name="q2" value="c"> La vida es como un sueño.</label><br>
                </div>
                <button type="submit"><i class="fa-solid fa-paper-plane"></i>Enviar Quiz</button>
            </form>
            <div id="quiz-results" class="correct-answer-box" style="display:none; margin-top: 1rem;"></div>
        </section>
    </main>
    
    <div class="fab-container">
        <button id="download-pdf" class="fab" title="Descargar como PDF"><i class="fa-solid fa-file-pdf"></i></button>
    </div>

    <footer class="main-footer">
        <p>&copy; 2025 - Estudio de Figuras Literarias | Desarrollado por Julio Cesar Pineda Mora</p>
    </footer>

    <script src="../lib/html2pdf.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- LÓGICA ORIGINAL DEL MÓDULO ---

            // Manejo del tema (Modo Oscuro/Claro)
            const themeToggle = document.getElementById('theme-toggle');
            const themeIcon = themeToggle.querySelector('i');
            const applyTheme = (theme) => {
                document.body.classList.remove('light-mode', 'dark-mode');
                document.body.classList.add(theme);
                localStorage.setItem('theme', theme);
                themeIcon.className = theme === 'dark-mode' ? 'fa-solid fa-sun' : 'fa-solid fa-moon';
                themeToggle.title = theme === 'dark-mode' ? 'Cambiar a modo claro' : 'Cambiar a modo oscuro';
            };
            themeToggle.addEventListener('click', () => {
                applyTheme(document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode');
            });
            applyTheme(localStorage.getItem('theme') || 'light-mode');

            // Verificación del ejercicio práctico
            const checkAnswerBtn = document.getElementById('check-answer-btn');
            const showAnswerBtn = document.getElementById('show-answer-btn');
            const feedbackEl = document.getElementById('feedback');
            const correctAnswerEl = document.getElementById('correct-answer');
            checkAnswerBtn.addEventListener('click', () => {
                const answer = document.getElementById('exercise-answer').value.toLowerCase();
                showAnswerBtn.style.display = 'none';
                correctAnswerEl.style.display = 'none';
                if (answer.includes("buenas nuevas") && answer.includes("agua fría")) {
                    feedbackEl.textContent = "¡Correcto! Has identificado perfectamente los dos elementos de la comparación.";
                    feedbackEl.style.color = 'var(--accent-color)';
                } else {
                    feedbackEl.textContent = "Respuesta incorrecta. Inténtalo de nuevo o revisa la respuesta correcta.";
                    feedbackEl.style.color = 'red';
                    showAnswerBtn.style.display = 'inline-block';
                }
            });
            showAnswerBtn.addEventListener('click', () => {
                correctAnswerEl.style.display = 'block';
                showAnswerBtn.style.display = 'none';
            });

            // Generador de PDF con feedback de carga
            document.getElementById('download-pdf').addEventListener('click', () => {
                const fabContainer = document.querySelector('.fab-container');
                const content = document.getElementById('module-content');
                const downloadBtn = document.getElementById('download-pdf');
                const originalIcon = downloadBtn.innerHTML;
                fabContainer.style.visibility = 'hidden';
                downloadBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i>';
                const opt = {
                    margin: 10, filename: 'modulo-simil.pdf', image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2, useCORS: true, letterRendering: true }, jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
                    pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
                };
                html2pdf().from(content).set(opt).save().then(() => {
                    fabContainer.style.visibility = 'visible';
                    downloadBtn.innerHTML = originalIcon;
                }).catch(err => {
                    console.error("Error al generar el PDF:", err);
                    fabContainer.style.visibility = 'visible';
                    downloadBtn.innerHTML = originalIcon;
                });
            });

            // --- LÓGICA PARA NUEVAS SECCIONES INTERACTIVAS ---

            // Lógica para la sección "Antes y Después"
            const transformBtn = document.getElementById('transform-btn');
            const beforeText = document.getElementById('before-text');
            const afterText = document.getElementById('after-text');
            if(transformBtn) { // Check if the element exists before adding listener
                transformBtn.addEventListener('click', () => {
                    if (afterText.style.display === 'none') {
                        beforeText.style.display = 'none';
                        afterText.style.display = 'block';
                        transformBtn.innerHTML = '<i class="fa-solid fa-rotate-left"></i> Mostrar Original';
                    } else {
                        beforeText.style.display = 'block';
                        afterText.style.display = 'none';
                        transformBtn.innerHTML = '<i class="fa-solid fa-repeat"></i> Mostrar Efecto';
                    }
                });
            }

            // Lógica para la sección "Identifícalo"
            document.querySelectorAll('.sentence-container').forEach(container => {
                // Adaptación: En "Tu risa suena tal cual música celestial", el término real no está explícito en un span.
                // Esta lógica funcionará para los que sí tienen los spans.
                let partsToFind = container.querySelectorAll('.simil-part');
                const feedbackFinderEl = container.querySelector('.feedback-finder');
                let foundCount = 0;
                
                // Hack para el segundo ejemplo: el término real es "Tu risa"
                if (container.querySelector('.find-me').innerText.includes("Tu risa")) {
                    const realTerm = container.querySelector('.find-me');
                    realTerm.innerHTML = realTerm.innerHTML.replace('Tu risa', '<span class="simil-part">Tu risa</span>');
                    partsToFind = container.querySelectorAll('.simil-part'); // Re-select to include the new one
                }

                partsToFind.forEach(part => {
                    part.addEventListener('click', () => {
                        if (!part.classList.contains('found')) {
                            part.classList.add('found');
                            foundCount++;
                            if (foundCount === partsToFind.length) {
                                feedbackFinderEl.textContent = '¡Excelente! Has encontrado todas las partes.';
                            }
                        }
                    }, { once: true });
                });
            });

            // Lógica para el Mini-Quiz
            const quizForm = document.getElementById('mini-quiz-form');
            if(quizForm) { // Check if the element exists
                quizForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const correctAnswers = { q1: 'b', q2: 'c' };
                    let score = 0;
                    const totalQuestions = Object.keys(correctAnswers).length;
                    const formData = new FormData(quizForm);
                    for (const [question, userAnswer] of formData.entries()) {
                        if (userAnswer === correctAnswers[question]) {
                            score++;
                        }
                    }
                    const resultsEl = document.getElementById('quiz-results');
                    resultsEl.innerHTML = `<h4>Resultados del Quiz</h4><p>Has acertado <strong>${score}</strong> de <strong>${totalQuestions}</strong> preguntas.</p>`;
                    if (score === totalQuestions) {
                        resultsEl.innerHTML += "<p>¡Felicidades! Has dominado el concepto de símil.</p>";
                    } else {
                        resultsEl.innerHTML += "<p>¡Buen intento! Repasa el módulo para afianzar los conceptos.</p>";
                    }
                    resultsEl.style.display = 'block';
                });
            }
        });
    </script>
</body>
</html>
