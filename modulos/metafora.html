<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Módulo: Metáfora</title>

    <!-- El CSS se mantiene exactamente igual -->
    <style>
        :root {
            --primary-bg-light: #f4f4f9; --primary-text-light: #333; --card-bg-light: #ffffff; --header-bg-light: #ffffff; --accent-color: #007bff; --mark-bg-light: #ffe066; --border-color-light: #e0e0e0; --success-bg-light: #e6ffed;
            --primary-bg-dark: #121212; --primary-text-dark: #e0e0e0; --card-bg-dark: #1e1e1e; --header-bg-dark: #1e1e1e; --mark-bg-dark: #b38f00; --border-color-dark: #333; --success-bg-dark: #1c3b29;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; transition: background-color 0.3s, color 0.3s; line-height: 1.6; }
        body.light-mode { background-color: var(--primary-bg-light); color: var(--primary-text-light); }
        body.dark-mode { background-color: var(--primary-bg-dark); color: var(--primary-text-dark); }
        .main-header { display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
        body.light-mode .main-header { background-color: var(--header-bg-light); }
        body.dark-mode .main-header { background-color: var(--header-bg-dark); }
        .main-header h1 { font-size: 1.5rem; margin: 0; }
        .theme-toggle-btn { background-color: var(--accent-color); color: white; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; }
        .main-footer { text-align: center; padding: 1rem; margin-top: 2rem; }
        .container { max-width: 1080px; margin: 2rem auto; padding: 0 1rem; }
        .module-section { padding: 2rem; border-radius: 8px; margin-bottom: 2rem; }
        body.light-mode .module-section { background-color: var(--card-bg-light); border: 1px solid var(--border-color-light); }
        body.dark-mode .module-section { background-color: var(--card-bg-dark); border: 1px solid var(--border-color-dark); }
        .module-section h2 { margin-top: 0; color: var(--accent-color); border-bottom: 2px solid var(--accent-color); padding-bottom: 0.5rem; }
        .back-link { text-decoration: none; color: var(--accent-color); font-weight: bold; }
        mark { padding: 0.2em 0.4em; border-radius: 3px; }
        body.light-mode mark { background-color: var(--mark-bg-light); }
        body.dark-mode mark { background-color: var(--mark-bg-dark); color: var(--primary-text-dark); }
        .formula { text-align: center; font-size: 1.2rem; padding: 1rem; border: 2px dashed var(--accent-color); border-radius: 5px; margin: 1rem 0; }
        .bible-example { margin-top: 1.5rem; }
        .bible-example em { display: block; padding-left: 1rem; border-left: 3px solid #ccc; margin-bottom: 0.5rem; font-style: italic; }
        .exercise textarea { width: 100%; box-sizing: border-box; padding: 0.5rem; border-radius: 5px; border: 1px solid #ccc; margin: 1rem 0; font-size: 1rem; }
        .exercise button { background-color: var(--accent-color); color: white; border: none; padding: 0.7rem 1.5rem; border-radius: 5px; cursor: pointer; margin-right: 0.5rem; }
        #show-answer-btn { background-color: #6c757d; }
        .feedback { margin-top: 1rem; font-weight: bold; min-height: 1.2em; }
        .correct-answer-box { margin-top: 1rem; padding: 1rem; border-radius: 5px; }
        body.light-mode .correct-answer-box { background-color: var(--success-bg-light); border: 1px solid green; }
        body.dark-mode .correct-answer-box { background-color: var(--success-bg-dark); border: 1px solid #3d8b40; }
        .fab-container { position: fixed; bottom: 2rem; right: 2rem; z-index: 1001; }
        .fab { background-color: var(--accent-color); color: white; border: none; border-radius: 50%; width: 60px; height: 60px; font-size: 1rem; text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.2); cursor: pointer; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <header class="main-header">
        <a href="../index.html" class="back-link">&larr; Volver al inicio</a>
        <h1>Metáfora</h1>
        <button id="theme-toggle" class="theme-toggle-btn">Fondo</button>
    </header>

    <main class="container" id="module-content">
       <!-- El contenido HTML se mantiene exactamente igual -->
        <section class="module-section">
            <h2>1. ¿Qué es una Metáfora?</h2>
            <p>En palabras simples, una metáfora es <strong>llamar a una cosa con el nombre de otra</strong> porque comparten alguna característica. Es una comparación directa y poética, pero sin usar la palabra "como".</p>
            <div class="formula">
                <p><strong>Término Real (A)</strong> se presenta como <strong>Término Imaginario (B)</strong></p>
            </div>
            <p>Por ejemplo, en "Tus ojos son <mark>dos luceros</mark>", el término real (ojos) se identifica directamente con el término imaginario (luceros) por la cualidad que comparten: el brillo.</p>
        </section>

        <section class="module-section">
            <h2>2. Ejemplos en la Vida Cotidiana</h2>
            <ul>
                <li>"Esa noticia fue un <mark>balde de agua fría</mark>." (Real: noticia / Imaginario: balde de agua fría / Semejanza: sorpresa desagradable).</li>
                <li>"Está que <mark>echa chispas</mark>." (Real: persona / Imaginario: objeto que echa chispas / Semejanza: estar muy enojado).</li>
                <li>"Mi primo es una <mark>oveja negra</mark>." (Real: primo / Imaginario: oveja negra / Semejanza: ser diferente al resto del grupo).</li>
            </ul>
        </section>

        <section class="module-section">
            <h2>3. Metáforas en la Biblia (Reina Valera 1960)</h2>
            <div class="bible-example">
                <em>"Yo soy la <mark>luz</mark> del mundo; el que me sigue, no andará en tinieblas, sino que tendrá la luz de la vida." (Juan 8:12)</em>
                <p><strong>Análisis:</strong> Jesús (Término Real) se identifica como "la luz" (Término Imaginario). La semejanza es que la luz guía, revela la verdad y disipa la oscuridad, que a su vez es una metáfora de la ignorancia y el pecado.</p>
            </div>
            <hr>
            <div class="bible-example">
                <em>"Vosotros sois la <mark>sal</mark> de la tierra..." (Mateo 5:13)</em>
                <p><strong>Análisis:</strong> Los creyentes (Término Real) son identificados como "la sal" (Término Imaginario). En la antigüedad, la sal preservaba los alimentos de la corrupción y daba sabor. La metáfora indica que los creyentes deben ser una influencia que preserve la moral y dé "sabor" o sentido al mundo.</p>
            </div>
             <hr>
            <div class="bible-example">
                <em>"Jehová es mi <mark>pastor</mark>; nada me faltará." (Salmo 23:1)</em>
                <p><strong>Análisis:</strong> Dios (Término Real) es presentado como un "pastor" (Término Imaginario). Un pastor cuida, guía, protege y alimenta a sus ovejas. La metáfora transmite una profunda sensación de confianza y cuidado divino.</p>
            </div>
        </section>

        <section class="module-section exercise">
            <h2>4. Ejercicio Práctico</h2>
            <p>Lee el siguiente versículo. Identifica el término real y el imaginario de la metáfora y explica brevemente su significado.</p>
            <p><em>"Lámpara es a mis pies tu palabra, Y lumbrera a mi camino." (Salmo 119:105)</em></p>
            <textarea id="exercise-answer" rows="10" placeholder="Término Real: ...&#10;Término Imaginario: ...&#10;Explicación: ..."></textarea>
            
            <button id="check-answer-btn">Verificar Respuesta</button>
            <button id="show-answer-btn" style="display: none;">Ver Respuesta Correcta</button>
            
            <p id="feedback" class="feedback"></p>

            <div id="correct-answer" class="correct-answer-box" style="display: none;">
                <h4>Respuesta Detallada:</h4>
                <p><strong>Término Real:</strong> "Tu palabra" (La enseñanza de Dios).</p>
                <p><strong>Término Imaginario:</strong> "Lámpara" y "Lumbrera".</p>
                <p><strong>Explicación:</strong> La palabra de Dios se compara con una fuente de luz porque, al igual que una lámpara ilumina los pasos inmediatos en la oscuridad y una lumbrera alumbra el camino a lo lejos, sus enseñanzas guían las decisiones diarias y el rumbo general de la vida de una persona.</p>
            </div>
        </section>
    </main>
    
    <div class="fab-container">
        <button id="download-pdf" class="fab">PDF</button>
    </div>

<footer class="main-footer">
    <p>&copy; 2025 - Estudio de Figuras Literarias | Desarrollado por Julio Cesar Pineda Mora</p>
</footer>


    <script src="../lib/html2pdf.bundle.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Lógica 1 y 2 sin cambios...
            const themeToggle = document.getElementById('theme-toggle');
            const storedTheme = localStorage.getItem('theme') || 'light-mode';
            document.body.classList.add(storedTheme);
            themeToggle.addEventListener('click', () => {
                const isDarkMode = document.body.classList.contains('dark-mode');
                document.body.classList.toggle('dark-mode', !isDarkMode);
                document.body.classList.toggle('light-mode', isDarkMode);
                localStorage.setItem('theme', isDarkMode ? 'light-mode' : 'dark-mode');
            });
            const checkAnswerBtn = document.getElementById('check-answer-btn');
            const showAnswerBtn = document.getElementById('show-answer-btn');
            const feedbackEl = document.getElementById('feedback');
            const correctAnswerEl = document.getElementById('correct-answer');
            checkAnswerBtn.addEventListener('click', () => {
                const answer = document.getElementById('exercise-answer').value.toLowerCase();
                showAnswerBtn.style.display = 'none';
                correctAnswerEl.style.display = 'none';
                if (answer.includes("palabra") && (answer.includes("lámpara") || answer.includes("lumbrera"))) {
                    feedbackEl.textContent = "¡Excelente! Has identificado los elementos clave de la metáfora.";
                    feedbackEl.style.color = 'var(--accent-color)';
                } else {
                    feedbackEl.textContent = "Respuesta incorrecta. Inténtalo de nuevo o revisa la respuesta correcta.";
                    feedbackEl.style.color = 'red';
                    showAnswerBtn.style.display = 'inline-block';
                }
            });
            showAnswerBtn.addEventListener('click', () => {
                correctAnswerEl.style.display = 'block';
                showAnswerBtn.style.display = 'none';
            });


            // =========================================================================
            // --- LÓGICA 3: GENERADOR DE PDF (OPTIMIZADO PARA TEXTO SELECCIONABLE) ---
            // =========================================================================
            document.getElementById('download-pdf').addEventListener('click', () => {
                const fabButton = document.querySelector('.fab-container');
                const content = document.getElementById('module-content');
                
                fabButton.style.visibility = 'hidden';
                const downloadBtn = document.getElementById('download-pdf');
                downloadBtn.textContent = '...';

                const opt = {
                    margin:       10,
                    filename:     'modulo-metafora.pdf',
                    image:        { type: 'jpeg', quality: 0.98 },
                    html2canvas:  { 
                        scale: 2, 
                        useCORS: true,
                        // ¡Esta es la opción clave para mejorar la renderización del texto!
                        letterRendering: true 
                    },
                    jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' },
                    pagebreak:    { mode: ['avoid-all', 'css', 'legacy'] },
                    // Nueva opción para priorizar el renderizado de texto
                    // "canvas" es el motor que mejor maneja esto.
                    renderer:     'canvas'
                };

                html2pdf().from(content).set(opt).save().then(() => {
                    fabButton.style.visibility = 'visible';
                    downloadBtn.textContent = 'PDF';
                });
            });
        });
    </script>
</body>
</html>
